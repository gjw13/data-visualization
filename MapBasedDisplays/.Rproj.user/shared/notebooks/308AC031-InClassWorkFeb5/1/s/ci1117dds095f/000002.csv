"0","# loading packages"
"0","library(tidyverse)"
"0","library(lubridate)"
"0","library(broom)"
"0","library(rgeos)"
"0","library(rgdal)"
"0","library(maptools)"
"0","library(mapproj)"
"0","# loading data files"
"0","sf_data <- read_csv(""sf.csv"")"
"2","Parsed with column specification:
cols(
  Incident_Type = [31mcol_character()[39m,
  Report_taken_date_EST = [31mcol_character()[39m,
  Year = [32mcol_double()[39m,
  `Data Type` = [31mcol_character()[39m,
  Subject_Race = [31mcol_character()[39m,
  Subject_Sex = [31mcol_character()[39m,
  Subject_Ethnicity = [31mcol_character()[39m,
  `Block Address` = [31mcol_character()[39m,
  `Incident Location District` = [31mcol_character()[39m,
  `Incident Location PSA` = [32mcol_double()[39m,
  Age = [31mcol_character()[39m
)
"
"0","sf_data_2017 <- read_csv(""sf2017.csv"")"
"2","Parsed with column specification:
cols(
  Incident_Type = [31mcol_character()[39m,
  Report_taken_date_EST = [31mcol_character()[39m,
  Year = [32mcol_double()[39m,
  `Data Type` = [31mcol_character()[39m,
  Subject_Race = [31mcol_character()[39m,
  Subject_Sex = [31mcol_character()[39m,
  Subject_Ethnicity = [31mcol_character()[39m,
  `Block Address` = [31mcol_character()[39m,
  `Incident Location District` = [31mcol_character()[39m,
  `Incident Location PSA` = [32mcol_double()[39m,
  Age = [31mcol_character()[39m
)
"
"0","#data cleanup"
"0","sf_data <- mutate(sf_data, date = mdy(Report_taken_date_EST),"
"0","                  Type=as.factor(`Data Type`),"
"0","                  Gender=as.factor(Subject_Sex),"
"0","                  Ethnicity=as.factor(Subject_Ethnicity),"
"0","                  Race=as.factor(Subject_Race),"
"0","                  District=as.factor(`Incident Location District`),"
"0","                  PSA=as.factor(`Incident Location PSA`),"
"0","                  Year=as.factor(Year)"
"0",")"
"0","# if age is juvenile or unknown = NA, otherwise age as numerical value"
"0","sf_data <- mutate(sf_data, num_age = "
"0","                    ifelse(Age==""Juvenile""|Age==""Unknown"","
"0","                           NA,as.numeric(Age)))"
"2","NAs introduced by coercion"
"0","# cutting age into 10-year groups"
"0","sf_data <- mutate(sf_data, cat_age = cut(num_age, "
"0","                                         breaks=c(17,27,37,47,57,67,77,87),"
"0","                                         labels=c(""18-27"",""28-37"",""38-47"","
"0","                                                  ""48-57"",""58-67"",""68-77"","
"0","                                                  ""78-87"")))"
"0","# add ""Juvenile"" and ""Unknown"" into categorical age variable"
"0","sf_data <- mutate(sf_data, cat_age = ifelse(Age==""Juvenile""|Age==""Unknown"",Age,"
"0","                                            as.character(cat_age)))"
"0","# rename categorical age variable to Age_binned, coerce to factor"
"0","# Make ""Juvenile"" the first level of that factor"
"0","sf_data <- mutate(sf_data, Age_binned=as.factor(cat_age))"
"0","sf_data <- mutate(sf_data, Age=fct_relevel(Age,""Juvenile""),"
"0","                  Age_binned=fct_relevel(Age_binned,""Juvenile""))"
"0","# create Month variable"
"0","sf_data <- mutate(sf_data, Month=month(date,label=T,abbr=F))"
"0","# import geospatial data about Police Service Areas"
"0","psas <- readOGR(""Police_Service_Areas.shp"",layer=""Police_Service_Areas"")"
"1","OGR data source with driver:"
"1"," "
"1","ESRI Shapefile"
"1"," "
"1","
"
"1","Source: """
"1","/Users/gjwills/Documents/Georgetown/Senior_Spring/Data_Viz/MapBasedDisplays/Police_Service_Areas.shp"
"1",""", layer: """
"1","Police_Service_Areas"
"1",""""
"1","
"
"1","with"
"1"," "
"1","56"
"1"," "
"1","features"
"1","
"
"1","It has"
"1"," "
"1","24"
"1"," "
"1","fields"
"1","
"
"1","Integer64 fields read as strings: "
"1"," "
"1","OBJECTID DISTRICT PSA TOTALPOP WHITE BLACK NAT_AMER ASIAN OTHER TWO_ORMORE HISPANIC POPMALE POPFEMALE POPUNDER18 POP65UP"
"1"," "
"1","
"
"0","# extracting the lat/long coordinates of PSA boundary points"
"0","# telling the tidy function that the region value can be found in the ""PSA"" variable"
"0","psas.points <- tidy(psas, region=""PSA"")"
"2","Unequal factor levels: coercing to character"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"0","# combine lat/long coordinates of district boundary points with data about districts"
"0","# tell join function that ""id"" in psas.points corresponds to ""PSA"" in psas@data"
"0","psas.cart <- full_join(psas.points, psas@data, by=c(""id"" = ""PSA""))"
"2","Column `id`/`PSA` joining character vector and factor, coercing into character vector"
